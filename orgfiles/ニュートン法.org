#+TAGS: math

下記の式を満たす x を求めることを考えてみる。

\[ f(x) = 0 \]

適当な予想値

\[ x_n \]

に対して、それよりも真の解に近い

\[ x_{n+1} \]

を見つけたい。接線の傾きはその導関数により定まる。

\[ f'(x_n) \]

そして接線は点

\[(x_n, f(x_n)) \]

を通過するから接線は下の等式を満たす。

\[ f(x_n) = f'(x_n) x_n + b \]

ここから切片を計算すると

\[ b = f(x_n) - f'(x_n) x_n \]

である。これで傾きと切片がわかったので、接線の式が求まる。
さらにx切片を x_{n+1} と定めると、接線は下記の点を通る。

\[ (x_{n+1}, 0) \]

これを接線の式に当てはめて計算する。

\begin{align}
                y &= f'(x_n) x + f(x_n) - f'(x_n) x_n \\
                0 &= f'(x_n) x_{n+1} + f(x_n) - f'(x_n) x_n \\
  f'(x_n) x_{n+1} &= - f(x_n) + f'(x_n) x_n \\
          x_{n+1} &= - \frac{f(x_n)}{f'(x_n)} + x_n \\
\end{align}

これを並び替えると、下記の漸化式が完成する。

\[ x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)} \]

この式は、推定値からある数

\[ \frac{f(x_n)}{f'(x_n)} \]

を差し引くとより精度の良い推定値が計算できることを表している。
この漸化式を使えば、平方根を計算することができる。たとえば

\begin{align}
 \sqrt{a} &= x \\
        a &= x^2 \\
        0 &= x^2 - a \\
\end{align}

であることから

\[ f(x) = x^2 - a \]

この関数に対してニュートン法を使えば a の平方根を求められる。
もっと具体的な例は wikipedia にある。

https://ja.wikipedia.org/wiki/%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%88%E3%83%B3%E6%B3%95
